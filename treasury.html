<html>
  <head>
    <title>Charts, logically graphed</title>
    <link rel="shortcut icon" href="/icon/favicon.ico" type="image/x-icon"></link>
    <link rel="icon" href="/icon/favicon.ico" type="image/x-icon"></link>
    <link rel='stylesheet' href='styles.css?version=2'></link>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>

   <center>
    <h2>Logicalgraphs, LLC</h2>

   <table border='1' width='85%'>
     <tr>
      <td style='vertical-align:top' width='20%'>
       <table border='0'>
        <tr><td><a href='index.html'>Dashboard</a></td></tr>
        <tr><td>Treasury</td></tr>
        <tr><td><hr/></td></tr>
        <tr><td><a href='pools.html'>Pools</a></td></tr>
       </table>
      </td>
      <td style='vertical-align:top' width='80%'>
       <table border='1' width='100%'>
        <tr><td align='center'>
         <table border="0" width='75%'>
   <tr>
    <td align="center"><h3>Treasury</h3><br/>
     <canvas id="pieChart" width="200" height="200"></canvas>
    </td>
   </tr>
   <tr>
    <td align="center">
     <canvas id="barChart" width="400" height="200"></canvas>
    </td>
   </tr>
  </table>
  </td></tr></table>
  </td></tr></table>
  </td></tr></table>

    <script src="libs/table.js"></script>
    <script src='libs/canvas-bg.js'></script>
    <script src='libs/colors.js'></script>
    <script src='libs/usd.js'></script>
    <script src='libs/tokens.js'></script>
    <script src="libs/charts/bar.js"></script>
    <script src="libs/charts/pie.js"></script>

    <script>
       fetch('data/treasury.tsv')
            .then(result => result.text())
            .then(data => {
   let [assets, idx] = sortedTable(data);
   const labels = usdLabels(idx);
   let amounts = parseData(assets, labels);
   barChartTbl1(labels, amounts);
   let todayish = amounts.pop().data;
   let labs = [];
   let amnts = [];
   let stables = 0;
   labels.forEach(([k, _v]) => {
      let val = todayish[k];
      if(k.includes('USD')) {
         stables += val;
      } else {
         labs.push(k);
         amnts.push(val);
      }
   });
   labs.push("stable");
   amnts.push(stables);
   doughnutChartTbl(labs, amnts, 'pieChart');
       });
    </script>
  </body>
</html>
